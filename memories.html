<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Memories</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="memories">
      <a href="index.html" class="back">Go back</a>
      <h1>Memories</h1>

      <p>
        Happy memories together i will cherish for the rest of my life !! i hope
        magustuhan niyo to ^^ love u all < 3
      </p>
      <audio src="memory-bg.mp3" loop id="memoryAudio"></audio>
      <div class="img-cont">
        <a href="#" class="top">Back to top</a>
        <div class="img">
          <img src="upload/23.jpg" alt="" />
          <img src="upload/105.jpg" alt="" />
          <img src="upload/45.jpg" alt="" />
          <img src="upload/12.jpg" alt="" />
          <img src="upload/98.jpg" alt="" />
          <img src="upload/34.jpg" alt="" />
          <img src="upload/76.jpg" alt="" />
          <img src="upload/3.jpg" alt="" />
          <img src="upload/56.jpg" alt="" />
          <img src="upload/119.jpg" alt="" />
          <img src="upload/28.jpg" alt="" />
          <img src="upload/91.jpg" alt="" />
          <img src="upload/15.jpg" alt="" />
          <img src="upload/67.jpg" alt="" />
          <img src="upload/42.jpg" alt="" />
          <img src="upload/83.jpg" alt="" />
          <img src="upload/9.jpg" alt="" />
          <img src="upload/112.jpg" alt="" />
          <img src="upload/51.jpg" alt="" />
          <img src="upload/95.jpg" alt="" />
          <img src="upload/87.jpg" alt="" />
          <img src="upload/37.jpg" alt="" />
          <img src="upload/78.jpg" alt="" />
          <img src="upload/20.jpg" alt="" />
          <img src="upload/104.jpg" alt="" />
          <img src="upload/61.jpg" alt="" />
          <img src="upload/1.jpg" alt="" />
          <img src="upload/89.jpg" alt="" />
          <img src="upload/32.jpg" alt="" />
          <img src="upload/116.jpg" alt="" />
          <img src="upload/48.jpg" alt="" />
          <img src="upload/73.jpg" alt="" />
          <img src="upload/25.jpg" alt="" />
          <img src="upload/99.jpg" alt="" />
          <img src="upload/54.jpg" alt="" />
          <img src="upload/81.jpg" alt="" />
          <img src="upload/17.jpg" alt="" />
          <img src="upload/108.jpg" alt="" />
          <img src="upload/40.jpg" alt="" />
          <img src="upload/93.jpg" alt="" />
          <img src="upload/6.jpg" alt="" />
          <img src="upload/120.jpg" alt="" />
          <img src="upload/35.jpg" alt="" />
          <img src="upload/85.jpg" alt="" />
          <img src="upload/29.jpg" alt="" />
          <img src="upload/110.jpg" alt="" />
          <img src="upload/57.jpg" alt="" />
          <img src="upload/14.jpg" alt="" />
          <img src="upload/96.jpg" alt="" />
          <img src="upload/43.jpg" alt="" />
          <img src="upload/71.jpg" alt="" />
          <img src="upload/22.jpg" alt="" />
          <img src="upload/102.jpg" alt="" />
          <img src="upload/64.jpg" alt="" />
          <img src="upload/11.jpg" alt="" />
          <img src="upload/88.jpg" alt="" />
          <img src="upload/36.jpg" alt="" />
          <img src="upload/114.jpg" alt="" />
          <img src="upload/50.jpg" alt="" />
          <img src="upload/75.jpg" alt="" />
          <img src="upload/27.jpg" alt="" />
          <img src="upload/101.jpg" alt="" />
          <img src="upload/59.jpg" alt="" />
          <img src="upload/82.jpg" alt="" />
          <img src="upload/19.jpg" alt="" />
          <img src="upload/107.jpg" alt="" />
          <img src="upload/44.jpg" alt="" />
          <img src="upload/92.jpg" alt="" />
          <img src="upload/8.jpg" alt="" />
          <img src="upload/117.jpg" alt="" />
          <img src="upload/33.jpg" alt="" />
          <img src="upload/86.jpg" alt="" />
          <img src="upload/30.jpg" alt="" />
          <img src="upload/111.jpg" alt="" />
          <img src="upload/55.jpg" alt="" />
          <img src="upload/16.jpg" alt="" />
          <img src="upload/97.jpg" alt="" />
          <img src="upload/41.jpg" alt="" />
          <img src="upload/72.jpg" alt="" />
          <img src="upload/24.jpg" alt="" />
          <img src="upload/103.jpg" alt="" />
          <img src="upload/62.jpg" alt="" />
          <img src="upload/13.jpg" alt="" />
          <img src="upload/90.jpg" alt="" />
          <img src="upload/38.jpg" alt="" />
          <img src="upload/115.jpg" alt="" />
          <img src="upload/52.jpg" alt="" />
          <img src="upload/77.jpg" alt="" />
          <img src="upload/26.jpg" alt="" />
          <img src="upload/100.jpg" alt="" />
          <img src="upload/58.jpg" alt="" />
          <img src="upload/84.jpg" alt="" />
          <img src="upload/18.jpg" alt="" />
          <img src="upload/109.jpg" alt="" />
          <img src="upload/46.jpg" alt="" />
          <img src="upload/94.jpg" alt="" />
          <img src="upload/7.jpg" alt="" />
          <img src="upload/118.jpg" alt="" />
          <img src="upload/31.jpg" alt="" />
          <img src="upload/87.jpg" alt="" />
          <img src="upload/2.jpg" alt="" />
          <img src="upload/113.jpg" alt="" />
          <img src="upload/53.jpg" alt="" />
          <img src="upload/80.jpg" alt="" />
          <img src="upload/21.jpg" alt="" />
          <img src="upload/106.jpg" alt="" />
          <img src="upload/65.jpg" alt="" />
          <img src="upload/10.jpg" alt="" />
          <img src="upload/79.jpg" alt="" />
          <img src="upload/39.jpg" alt="" />
          <img src="upload/4.jpg" alt="" />
          <img src="upload/69.jpg" alt="" />
          <img src="upload/47.jpg" alt="" />
          <img src="upload/5.jpg" alt="" />
          <img src="upload/70.jpg" alt="" />
          <img src="upload/49.jpg" alt="" />
          <img src="upload/63.jpg" alt="" />
          <img src="upload/68.jpg" alt="" />
          <img src="upload/60.jpg" alt="" />
          <img src="upload/74.jpg" alt="" />
          <img src="upload/66.jpg" alt="" />
        </div>
      </div>
      <div class="audio-control">
        <button class="volume-btn">🔊</button>
        <input
          type="range"
          class="volume-slider"
          min="0"
          max="1"
          step="0.1"
          value="1"
        />
      </div>
      <div class="photo-counter">
        <span>120 memories and counting...</span>
      </div>
    </div>
    <div class="loader-container">
      <div class="loader"></div>
      <p>Loading memories...</p>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const audio = document.getElementById("memoryAudio");
        const memories = document.querySelector(".memories");
        const loader = document.querySelector(".loader-container");
        const volumeBtn = document.querySelector(".volume-btn");
        const volumeSlider = document.querySelector(".volume-slider");
        let imagesLoaded = 0;
        const totalImages = document.querySelectorAll("img").length;

        // Function to check if all images are loaded
        function imageLoaded() {
          imagesLoaded++;
          const progress = Math.round((imagesLoaded / totalImages) * 100);
          document.querySelector(
            ".loader-container p"
          ).textContent = `Loading memories... ${progress}%`;
          if (imagesLoaded === totalImages) {
            // All images loaded
            setTimeout(() => {
              loader.style.opacity = "0";
              memories.classList.add("loaded");
              setTimeout(() => {
                loader.style.display = "none";
              }, 500);
            }, 1000);
          }
        }

        // Check each image
        document.querySelectorAll("img").forEach((img) => {
          if (img.complete) {
            imageLoaded();
          } else {
            img.addEventListener("load", imageLoaded);
            img.addEventListener("error", imageLoaded); // Count errors as loaded
          }
        });

        // Existing audio code
        try {
          audio.play();
        } catch (err) {
          console.log("Audio autoplay was prevented");
        }

        document.body.addEventListener(
          "click",
          function () {
            if (audio.paused) {
              audio.play();
            }
          },
          { once: true }
        );

        // Audio controls
        volumeBtn.addEventListener("click", () => {
          if (audio.muted) {
            audio.muted = false;
            volumeBtn.textContent = "🔊";
            volumeSlider.value = audio.volume;
          } else {
            audio.muted = true;
            volumeBtn.textContent = "🔈";
            volumeSlider.value = 0;
          }
        });

        // Volume slider control
        volumeSlider.addEventListener("input", (e) => {
          const value = e.target.value;
          audio.volume = value;
          volumeBtn.textContent = value > 0 ? "🔊" : "🔈";
          audio.muted = value === "0";
        });

        // Initialize volume
        audio.volume = volumeSlider.value;
      });

      const topButton = document.querySelector(".top");

      window.addEventListener("scroll", () => {
        if (window.pageYOffset > 300) {
          topButton.classList.add("show");
          document.querySelector(".photo-counter").classList.add("show");
        } else {
          topButton.classList.remove("show");
          document.querySelector(".photo-counter").classList.remove("show");
        }
      });

      // Smooth scroll to top when clicked
      topButton.addEventListener("click", (e) => {
        e.preventDefault();
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      });

      // Add after your existing DOMContentLoaded event listener
      function createFallingElements() {
        const elements = ["💝", "✨", "💫", "💕"];
        setInterval(() => {
          const element = document.createElement("div");
          element.className = "falling-element";
          element.textContent =
            elements[Math.floor(Math.random() * elements.length)];
          element.style.left = Math.random() * 100 + "vw";
          element.style.fontSize = Math.random() * 20 + 10 + "px";
          element.style.animationDuration = Math.random() * 5 + 3 + "s";
          document.body.appendChild(element);

          // Remove element after animation
          setTimeout(() => element.remove(), 8000);
        }, 300);
      }

      createFallingElements();

      document.querySelectorAll(".img img").forEach((img) => {
        img.addEventListener("click", function () {
          const lightbox = document.createElement("div");
          lightbox.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            cursor: pointer;
          `;

          const imgClone = this.cloneNode();
          imgClone.style.cssText = `
            max-width: 90%;
            max-height: 90vh;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
          `;

          lightbox.appendChild(imgClone);
          document.body.appendChild(lightbox);

          lightbox.addEventListener("click", () => {
            lightbox.remove();
          });
        });
      });

      // Initial confetti explosion
      confetti({
        particleCount: 100, // Reduced from 200
        spread: 70,
        origin: { y: 0.6 },
      });

      // Continuous confetti bursts
      (function frame() {
        confetti({
          particleCount: 20, // Reduced from 40
          angle: 60,
          spread: 55,
          origin: { x: 0 },
        });

        confetti({
          particleCount: 20, // Reduced from 40
          angle: 120,
          spread: 55,
          origin: { x: 1 },
        });

        if (Date.now() < end) {
          requestAnimationFrame(frame);
        }
      })();
    </script>
  </body>
</html>
